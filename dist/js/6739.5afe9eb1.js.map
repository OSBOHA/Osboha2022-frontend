{"version":3,"file":"js/6739.5afe9eb1.js","mappings":"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","sources":["webpack://Osboha180/./src/API/services/notifications.service.js","webpack://Osboha180/./src/API/services/profile.images.service.js","webpack://Osboha180/./src/views/OsbohaMain/Notifications/Notification.vue","webpack://Osboha180/./src/views/OsbohaMain/Notifications/Notification.vue?d665"],"sourcesContent":["import { api } from \"../Intercepter\";\n\nclass Notifications {\n  \n  constructor(){\n    this.prefix = 'notifications'\n}\n\n  /**\n   * list all Unread Notifications.\n   * @return Unread Notifications\n   */\n  async listUnreadNotification() {\n    try {\n      const response = await api.get(`${this.prefix}/un-read`);\n      return response.data.data;\n    } catch (error) {\n      return error;\n    }\n  }\n  /**\n   * list all Notifications.\n   * @return Unread Notifications\n   */\n  async listAllNotification(page) {\n    try {\n      const response = await api.get(`${this.prefix}/list-all?page=${page}`);\n      return response.data.data;\n    } catch (error) {\n      return error;\n    }\n  }\n  /**\n   * mark one notification as read\n   * @param notification_id\n   */\n  async markAsRead(notification_id) {\n    try {\n      const response = await api.get(`${this.prefix}/mark-as-read/${notification_id}`);\n      return response.data.data;\n    } catch (error) {\n      return error;\n    }\n  }\n\n  /**\n   * mark ALL notifications as read\n   * @param notification_id\n   */\n  async markAllAsRead() {\n    try {\n      const response = await api.get(`${this.prefix}/mark-all-as-read`);\n      return response.data.data;\n    } catch (error) {\n      return error;\n    }\n  }\n\n}\n\nexport default new Notifications();","import { baseURL } from \"../Intercepter\";\r\n\r\nclass profileImagesService {\r\n  /**\r\n   * get profile picture or cover.\r\n   *  @param  image size, image name, profile id\r\n   * @return image url\r\n   */\r\n  resolve_porfile_img(size, imageName, profile_id) {\r\n    let image = size + \"_\" + imageName;\r\n    // const url = `${baseURL}/profile-image?fileName=${image}&profileID=${profile_id}`\r\n    const url = `${baseURL}/profile-image/${profile_id}/${image}`;\r\n    return url;\r\n  }\r\n}\r\n\r\nexport default new profileImagesService();\r\n","<template>\n  <div class=\"row\" ref=\"listContainer\">\n    <div class=\"col-sm-12\">\n      <h4 class=\"card-title\">الاشعارات</h4>\n      <span role=\"button\" class=\"btn btn-primary mb-3\" v-if=\"unRead\" style=\"direction: rtl !important;\"\n        @click=\"markAllAsRead()\">\n        <i role=\"button\" class=\"material-symbols-outlined align-middle\">\n          done\n        </i>\n\n        تحديد قراءة الكل\n      </span>\n    </div>\n    <div class=\"col-sm-12\" v-for=\"(notification, index) in notifications\" :key=\"index\">\n      <iq-card :class=\"seenClass(notification.read_at)\">\n        <template v-slot:body>\n          <div class=\"notification-list m-0 p-0\">\n            <div class=\"d-flex align-items-center justify-content-between\">\n              <div class=\"user-img img-fluid\">\n                <img v-if=\"notification.data.sender.user_profile.profile_picture\"\n                  :src=\"resolve_porfile_img('60x60', notification.data.sender.user_profile.profile_picture, notification.data.sender.user_profile.id)\"\n                  alt=\"profile-img\" class=\"rounded-circle avatar-40\" :title=\"notification.data.sender.name\" />\n\n                <img v-else\n                  :src=\"resolve_porfile_img('60x60', 'ananimous_' + notification.data.sender.gender + '.png', 'ananimous')\"\n                  alt=\"profile-img\" :title=\"notification.data.sender.name\" class=\"rounded-circle avatar-40\">\n\n              </div>\n              <div class=\"w-100\">\n                <div class=\"d-flex justify-content-between\">\n                  <div class=\" ms-3\">\n                    <h6>{{ notification.data.message }}</h6>\n                    <tooltip tag=\"span\" class=\"text-muted small\" tooltipPlacement=\"bottom\" data-bs-toggle=\"tooltip\"\n                      :title=\"formatFullDate(notification.created_at)\">{{ formatDateToWritten(notification.created_at) }}\n                    </tooltip>\n                  </div>\n\n                  <div class=\"d-flex align-items-center\">\n                    <router-link class=\"me-1\"\n                    :to=\"{ name: notification_route[notification.data.type], params: { user_id: 1 } }\">\n\n                      عرض\n                    </router-link>\n                    <i role=\"button\" class=\"material-symbols-outlined md-18 me-3\" v-if=\"!notification.read_at\"\n                      @click=\"markAsRead(notification.id)\">\n                      done\n                    </i>\n\n                  </div>\n\n                </div>\n              </div>\n            </div>\n          </div>\n        </template>\n      </iq-card>\n    </div>\n  </div>\n</template>\n<script>\nimport helper from \"@/utilities/helper\";\nimport notificationsServices from \"@/API/services/notifications.service\";\nimport profileImagesService from '@/API/services/profile.images.service'\n\nexport default {\n  name: 'Notification',\n  created() {\n    this.loadNotifications();\n\n  },\n  async mounted() {\n    window.addEventListener(\"scroll\", this.handleScroll);\n  },\n  beforeUnmount() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n  },\n  data() {\n    return {\n      notifications: [],\n      notifications_route: [\n\n      ],\n      notification_route: \n        {\n          friends_requests: \"user.friendsRequests\",\n        },       \n      \n      page: 1,\n      totalPages: 1,\n      loading: false,\n      pendingRequest: false,\n      hasMore: true,\n      unRead: false,\n\n    }\n  },\n  computed: {\n    hasMoreToLoad() {\n      return this.page <= this.totalPages && this.hasMore;\n    },\n  },\n  methods: {\n    ...helper,\n    /**\n* get profile picture or cover.\n*  @param  image size, image name, profile id\n* @return image url\n*/\n    resolve_porfile_img(size, imageName, profile_id) {\n      return profileImagesService.resolve_porfile_img(size, imageName, profile_id);\n    },\n    async loadNotifications() {\n      if (this.pendingRequest) {\n        return;\n      }\n\n      this.pendingRequest = true;\n      this.loading = true;\n      try {\n\n        let response = await notificationsServices.listAllNotification(this.page);\n        this.notifications = response.data;\n        console.log(this.notifications)\n\n        this.checkUnread()\n\n        this.totalPages = response.data?.last_page ?? 1;\n        this.page++;\n\n        if (response.statusCode === 200 && !response.data) {\n          this.hasMore = false;\n          return;\n        }\n\n      } catch (error) {\n        console.log(error);\n        helper.toggleToast(\n          \"حدث خطأ أثناء تحميل المنشورات, حاول مرة أخرى\",\n          \"error\"\n        );\n      } finally {\n        this.loading = false;\n        this.pendingRequest = false;\n      }\n    },\n    /**\n     * Check if the user has scrolled to the bottom of the page\n     * @returns {boolean}\n     */\n    isAtBottomOfPage() {\n      const containerRect = this.$refs.listContainer.getBoundingClientRect();\n      const containerBottom = containerRect.bottom;\n      const windowHeight = window.innerHeight;\n      return containerBottom <= windowHeight;\n    },\n    /*\n     * Load more posts when the user scrolls to the bottom of the page\n     */\n    handleScroll() {\n      if (this.hasMoreToLoad && this.isAtBottomOfPage()) {\n        this.loadNotifications();\n      }\n    },\n\n    /**\n    * return bg color class.\n    *  @param  read_at\n    * @return class\n    */\n    seenClass(read_at) {\n      if (read_at) {\n        return 'seen'\n      }\n      else {\n        return 'un-seen'\n      }\n    },\n    /**\n    * mark one notification as read.\n    *  @param  notification_id\n    */\n    async markAsRead(notification_id) {\n      const response = await notificationsServices.markAsRead(notification_id);\n      this.notifications = response.data;\n      this.checkUnread()\n    },\n\n    /**\n    * mark ALL notification as read.\n   */\n    async markAllAsRead() {\n      console.log('tet')\n      const response = await notificationsServices.markAllAsRead();\n      this.notifications = response.data;\n      this.checkUnread()\n    },\n    checkUnread() {\n      function there_is_unread(notification) {\n        return (notification.read_at === null);\n      }\n      // check unread\n      if (this.notifications.find(there_is_unread)) {\n        this.unRead = true;\n      }\n\n    },\n  },\n}\n</script>\n\n<style scoped>\n.seen {\n  --bs-bg-opacity: 1;\n  background-color: white;\n}\n\n.un-seen {\n  --bs-bg-opacity: 1;\n  background-color: #e2e2e2;\n}\n</style>\n  ","import { render } from \"./Notification.vue?vue&type=template&id=4a3890d5&scoped=true\"\nimport script from \"./Notification.vue?vue&type=script&lang=js\"\nexport * from \"./Notification.vue?vue&type=script&lang=js\"\n\nimport \"./Notification.vue?vue&type=style&index=0&id=4a3890d5&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\someO\\\\Desktop\\\\vue\\\\osboha2022\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4a3890d5\"]])\n\nexport default __exports__"],"names":["Notifications","constructor","this","prefix","response","api","data","error","page","notification_id","profileImagesService","resolve_porfile_img","size","imageName","profile_id","image","url","baseURL","class","ref","_createElementVNode","role","_createElementBlock","_hoisted_3","$data","style","onClick","$options","_hoisted_4","_Fragment","_renderList","notification","index","key","_createVNode","_component_iq_card","read_at","body","sender","user_profile","profile_picture","src","id","alt","title","name","gender","_toDisplayString","message","_component_tooltip","tag","tooltipPlacement","_ctx","created_at","_component_router_link","to","type","params","user_id","_hoisted_14","created","loadNotifications","async","window","addEventListener","handleScroll","beforeUnmount","removeEventListener","notifications","notifications_route","notification_route","friends_requests","totalPages","loading","pendingRequest","hasMore","unRead","computed","hasMoreToLoad","methods","helper","notificationsServices","console","log","checkUnread","last_page","statusCode","isAtBottomOfPage","containerRect","$refs","listContainer","getBoundingClientRect","containerBottom","bottom","windowHeight","innerHeight","seenClass","there_is_unread","find","__exports__","render"],"sourceRoot":""}