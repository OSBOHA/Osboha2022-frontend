"use strict";(self["webpackChunkOsboha180"]=self["webpackChunkOsboha180"]||[]).push([[4193],{34964:function(e,t,s){var a=s(24150),o=s(66252),i=s(79940);class l{async create(e,t,s,o,i,l,r,n,d,c,h){let m=new FormData;m.append("name",e),m.append("writer",t),m.append("start_page",i),m.append("end_page",l),m.append("publisher",s),m.append("brief",o),m.append("link",r),m.append("type_id",h),m.append("section_id",n),m.append("level",c),m.append("image",d);try{const e=await a.hi.post("/books",m,{headers:{"Content-type":"multipart/form-data"}});return e.data}catch(u){return u}}async getAll(e){try{const t=await a.hi.get("books?page="+e);return t.data.data}catch(t){(0,o.S3)(t)}}async getById(e){try{const t=await a.hi.get(`/books/${e}`);return t.data}catch(t){(0,i.F)(t,"BookService.getById")}}async deleteById(e){try{return await a.hi["delete"](`/books/${e}`)}catch(t){return t}}async getBooksByType(e){try{const t=await a.hi.get(`/books/type/${e}`);return t.data}catch(t){return t}}async getBooksByLevel(e,t){try{const s=await a.hi.get(`/books/level/${e}?page=${t}`);return s.data.data}catch(s){(0,o.S3)(s)}}async getBooksByName(e,t){try{const s=await a.hi.post(`/books/name?page=${t}`,{name:e});return s.data.data}catch(s){(0,o.S3)(s)}}async getBooksByLanguage(e,t){try{const s=await a.hi.get(`/books/language/${e}?page=${t}`);return s.data.data}catch(s){(0,o.S3)(s)}}async getBooksBySection(e){try{const t=await a.hi.get(`/books/section/${e}`);return t.data}catch(t){return t}}async getRecentAddedBooks(){try{const e=await a.hi.get("/books/recent-added-books");return e.data.data}catch(e){return console.log(e),""}}async getMostReadableBooks(){try{const e=await a.hi.get("/books/most-readable-books");return e.data.data}catch(e){return console.log(e),""}}async getRandomBook(){try{const e=await a.hi.get("/books/random-book");return e.data.data}catch(e){return console.log(e),""}}async latestBooks(){try{const e=await a.hi.get("/books/latest");return e.data.data}catch(e){return console.log(e),""}}}t["Z"]=new l},26045:function(e,t,s){var a=s(24150),o=s(66252);class i{async getThesisById(e){try{const t=await a.hi.get(`/theses/${e}`);return t.data.data}catch(t){(0,o.S3)(t)}}async getBookThesis(e,t){try{const s=await a.hi.get(`/theses/book/${e}/thesis/${t}`);return s.data}catch(s){(0,o.S3)(s)}}async getThesesByBookId(e,t,s=""){try{const o=await a.hi.get(`/theses/book/${e}/user/${s}?page=${t}`);return o.data}catch(i){(0,o.S3)(i)}}async getThesisByUser(e,t){try{const s=await a.hi.get(`/theses/user/${e}?page=${t}`);return s.data}catch(s){(0,o.S3)(s)}}async getThesisByWeek(e){try{const t=await a.hi.get(`/theses/week/${e}`);return t.data}catch(t){(0,o.S3)(t)}}}t["Z"]=new i},91130:function(e,t,s){s.d(t,{Z:function(){return g}});var a=s(66252);const o={class:"preview-images"},i=["onClick"],l=(0,a._)("span",null," x ",-1),r=[l],n=["src"],d=["src"];function c(e,t,s,l,c,h){return(0,a.wg)(),(0,a.iD)("div",o,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(c.previewUrls,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"image-container",key:e.url},[(0,a._)("div",{class:"delete-image",onClick:e=>h.removeMedia(t)},r,8,i),e.type.includes("image")?((0,a.wg)(),(0,a.iD)("img",{key:0,src:e.url},null,8,n)):((0,a.wg)(),(0,a.iD)("video",{key:1,src:e.url,autoplay:""},null,8,d))])))),128))])}var h={name:"ImagePreviewer",props:{media:{type:[Array,FileList],default:()=>[]}},emits:["remove-media"],data(){return{previewUrls:[]}},methods:{previewMedia(){this.previewUrls=[];const e=[...this.media];e.forEach((e=>{const t=new FileReader;t.onload=()=>{this.previewUrls.push({url:t.result,type:e.type})},t.readAsDataURL(e)}))},removeMedia(e){this.previewUrls.splice(e,1),this.$emit("remove-media",e)},clearMedia(){this.previewUrls=[]}},mounted(){this.previewMedia()},watch:{media(){this.previewMedia()}}},m=s(83744);const u=(0,m.Z)(h,[["render",c]]);var g=u},41490:function(e,t,s){s.r(t),s.d(t,{default:function(){return me}});var a=s(66252),o=s(3577);const i={class:"row"},l={class:"col-lg-12"},r={class:"card card-block card-stretch card-height blog blog-detail"},n={class:"card-body"},d={class:"position-absolute start-0"},c={class:"image-block text-center mt-3"},h=["src"],m={class:"blog-description mt-3 text-center"},u={class:"mb-3 pb-3 border-bottom text-center"},g={class:"blog-meta d-flex align-items-center mb-3 position-right-side flex-wrap"},b={class:"date me-4 d-flex align-items-center"},k=(0,a._)("i",{class:"material-symbols-outlined pe-2 md-18 text-primary"},"calendar_month",-1),p={class:"like me-4 d-flex align-items-center"},y=(0,a._)("i",{class:"material-symbols-outlined pe-2 md-18 text-primary"}," star ",-1),_={class:"comments me-4 d-flex align-items-center"},f=(0,a._)("i",{class:"material-symbols-outlined pe-2 md-18 text-primary"}," book ",-1),w={class:"comments me-4 d-flex align-items-center"},v=(0,a._)("i",{class:"material-symbols-outlined pe-2 md-18 text-primary"}," comment ",-1),T={class:"comments me-4 d-flex align-items-center"},B=(0,a._)("i",{class:"material-symbols-outlined pe-2 md-18 text-primary"}," mode_comment ",-1),x={class:"text-center"},C={key:0,class:"col-lg-12"},$=(0,a._)("div",{class:"card card-block card-stretch card-height blog"},[(0,a._)("button",{type:"submit",class:"btn btn-primary d-block w-100","data-bs-toggle":"modal","data-bs-target":"#modals"}," كتابة أطروحة ")],-1),D=[$],M={class:"col-lg-12"},U={class:"card card-block card-stretch card-height blog user-comment"},Z=(0,a._)("div",{class:"card-header d-flex justify-content-between"},[(0,a._)("div",{class:"header-title"},[(0,a._)("h4",{class:"card-title"},"الأطروحات")])],-1),L={class:"card-body"},S={key:0,class:"row"},z={class:"card card-block card-stretch card-height blog"},W={class:"card-body"},I=(0,a._)("h5",{class:"modal-title",id:"modalsLabel"},"تعديل الأطروحة",-1),A=(0,a._)("span",{class:"material-symbols-outlined"},"close",-1),R=[A],q={key:0,class:"col-sm-12 text-center"},Y=["src"],E={class:"col-lg-12"},F={class:"card card-block card-stretch card-height blog"},j=["disabled"],O={key:1,class:"row"},P={class:"col-lg-12"},H={class:"text-center d-flex align-items-center"},K=(0,a._)("span",{class:"material-symbols-outlined"}," comments_disabled ",-1),N={key:0,class:"ms-2"},G={key:1,class:"ms-2"},J={key:0},Q={class:"modal-title",id:"modalsLabel"},V={href:"javascript:void(0);",class:"lh-1","data-bs-dismiss":"modal",ref:"closeBtn"},X=(0,a._)("span",{class:"material-symbols-outlined"},"close",-1),ee=[X];function te(e,t,$,A,X,te){const se=(0,a.up)("Comment"),ae=(0,a.up)("model-header"),oe=(0,a.up)("createThesis"),ie=(0,a.up)("model-body"),le=(0,a.up)("modal");return(0,a.wg)(),(0,a.iD)("main",null,[(0,a._)("div",i,[(0,a._)("div",l,[(0,a._)("div",r,[(0,a._)("div",n,[(0,a._)("div",d,[(0,a._)("span",{role:"button",onClick:t[0]||(t[0]=e=>te.download(X.book?.book?.link)),class:"material-symbols-outlined align-middle display-4 me-3"}," download ")]),(0,a._)("div",c,[(0,a._)("img",{src:te.resolve_img_url(X.book?.book?.media?.path??""),class:"img-fluid rounded w-25",alt:"blog-img"},null,8,h)]),(0,a._)("div",m,[(0,a._)("h2",u,(0,o.zw)(X.book?.book?.name),1),(0,a._)("div",g,[(0,a._)("div",b,[k,(0,a.Uk)("تاريخ الاضافة "+(0,o.zw)(te.formattedDate),1)]),(0,a._)("div",p,[y,(0,a.Uk)(" "+(0,o.zw)(X.book?.rate)+"% تقييم ",1)]),(0,a._)("div",_,[f,(0,a.Uk)(" عدد الصفحات: "+(0,o.zw)(X.book?.book?.end_page),1)]),(0,a._)("div",w,[v,(0,a.Uk)((0,o.zw)(X.book?.theses_count)+" أطروحة ",1)]),(0,a._)("div",T,[B,(0,a.Uk)((0,o.zw)(X.book?.comments_count)+" تعليق ",1)])]),(0,a._)("div",x,[(0,a.Uk)((0,o.zw)(X.shortBriefText)+" ",1),te.isMore?((0,a.wg)(),(0,a.iD)("a",{key:0,class:"load-btn",onClick:t[1]||(t[1]=(...e)=>te.loadMoreBriefText&&te.loadMoreBriefText(...e))},"...قراءة المزيد")):(0,a.kq)("",!0),te.isLess?((0,a.wg)(),(0,a.iD)("a",{key:1,class:"load-btn",onClick:t[2]||(t[2]=(...e)=>te.loadLessBriefText&&te.loadLessBriefText(...e))},"قراءة أقل")):(0,a.kq)("",!0)])])])])]),X.book?.book?.allow_comments?((0,a.wg)(),(0,a.iD)("div",C,D)):(0,a.kq)("",!0),(0,a._)("div",M,[(0,a._)("div",U,[Z,(0,a._)("div",L,[X.theses.length?((0,a.wg)(),(0,a.iD)("div",S,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(X.theses,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"col-lg-12",key:e.id},[(0,a._)("div",z,[(0,a._)("div",W,[(0,a.Wm)(se,{allowComment:X.book?.book?.allow_comments,comment:e,totalThesisPages:e.thesis&&e.thesis.end_page-e.thesis.start_page>0?e.thesis.end_page-e.thesis.start_page+1:0,onAddComment:te.addComment,onEditComment:te.editComment,onReactToComment:te.reactToComment},null,8,["allowComment","comment","totalThesisPages","onAddComment","onEditComment","onReactToComment"])])]),(0,a.Wm)(le,{id:`editThesis-${e.id}`,ref_for:!0,ref:"editThesisRef",dialogClass:"modal-dialog-centered modal-dialog-scrollable",tabindex:"-1","aria-labelledby":"editThesis","aria-hidden":!1},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[I,(0,a._)("a",{href:"javascript:void(0);",class:"lh-1","data-bs-dismiss":"modal",ref_for:!0,ref:"editCloseBtn"},R,512)])),_:1}),(0,a.Wm)(ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(oe,{book:X.book?.book,thesisToEdit:e},null,8,["book","thesisToEdit"])])),_:2},1024)])),_:2},1032,["id"])])))),128)),X.loading?((0,a.wg)(),(0,a.iD)("div",q,[(0,a._)("img",{src:s(79885),alt:"loader",style:{height:"100px"}},null,8,Y)])):(0,a.kq)("",!0),(0,a._)("div",E,[(0,a._)("div",F,[te.hasMoreTheses?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"button",class:"btn btn-primary d-block w-100",onClick:t[3]||(t[3]=(...e)=>te.loadMoreTheses&&te.loadMoreTheses(...e)),disabled:X.loading}," تحميل المزيد ",8,j)):(0,a.kq)("",!0)])])])):((0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",P,[(0,a._)("div",H,[K,e.$route.params.thesis_id?((0,a.wg)(),(0,a.iD)("h5",N," لم يتم العثور على هذه الأطروحة ")):((0,a.wg)(),(0,a.iD)("h5",G,[(0,a.Uk)(" لا يوجد أطروحات "),e.$route.params.user_id?((0,a.wg)(),(0,a.iD)("span",J,"لهذا السفير")):(0,a.kq)("",!0)]))])])]))])])])]),(0,a.Wm)(le,{id:"modals",ref:"modals",dialogClass:"modal-dialog-centered modal-dialog-scrollable",tabindex:"-1","aria-labelledby":"modalsLabel","aria-hidden":!1},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,null,{default:(0,a.w5)((()=>[(0,a._)("h5",Q,(0,o.zw)(X.book?.book?.name)+" || أطروحة جديدة ",1),(0,a._)("a",V,ee,512)])),_:1}),(0,a.Wm)(ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(oe,{book:X.book?.book,lastThesis:X.book?.last_thesis,onCloseModel:te.closeModel,onAddThesis:te.addThesis},null,8,["book","lastThesis","onCloseModel","onAddThesis"])])),_:1})])),_:1},512)])}var se=s(72126),ae=(s(96648),s(28143)),oe=s(34964),ie=s(26045),le=s(30381),re=s.n(le),ne=s(8209),de={name:"BookDetails",components:{Comment:se.Z,createThesis:ae.Z},provide(){return{deleteComment:this.deleteComment}},async created(){await this.getBook(this.$route.params.book_id),await this.getTheses(this.page)},data(){return{theses:[],book:null,fullBriefText:"",shortBriefText:"",page:1,totalTheses:0,loading:!1}},methods:{async getBook(e){const t=await oe.Z.getById(e);this.book=t.data,this.fullBriefText=this.book.book?.brief,this.shortBriefText=this.fullBriefText?.slice(0,200)},loadMoreBriefText(){this.shortBriefText=this.fullBriefText},loadLessBriefText(){this.shortBriefText=this.fullBriefText?.slice(0,200)},resolve_img_url:function(e){return e||s(21218)},async getTheses(e){if(!this.loading&&this.book){this.loading=!0;try{let t;t=this.$route.params.thesis_id?await ie.Z.getBookThesis(this.$route.params.book_id,this.$route.params.thesis_id):await ie.Z.getThesesByBookId(this.$route.params.book_id,e,this.$route.params.user_id??""),200===t.statusCode?(this.theses.push(...t.data.theses),this.totalTheses=t.data.total):ne.Z.toggleToast("حدث خطأ أثناء تحميل البيانات, الرجاء المحاولة مرة أخرى","error")}catch(t){ne.Z.toggleToast("حدث خطأ أثناء تحميل البيانات, الرجاء المحاولة مرة أخرى","error")}finally{this.loading=!1}}},async loadMoreTheses(){this.page++,await this.getTheses(this.page)},async closeModel(){this.$refs.closeBtn.click()},addThesis(e){this.theses.unshift(e),this.book.theses_count++,this.book.comments_count=this.book.comments_count+e.replies.length+1,this.totalTheses++,this.book.book.userBooks=e.user.userBooks,this.book.last_thesis=e.thesis,this.book.book.userBooks.length>0&&"finished"===this.book.book.userBooks[0].status&&ne.Z.toggleToast("تهانينا, لقد أنهيت الكتاب","success")},findComment(e,t){for(let s=0;s<e.length;s++){if(e[s].id===t)return e[s];if(e[s].replies.length>0){const a=this.findComment(e[s].replies,t);if(a)return a}}},addComment(e,t){if(!t)return this.theses.push(e),this.book.comments_count++,void this.totalTheses++;{const s=this.findComment(this.theses,t);s.replies.push(e),this.book.comments_count++,console.log("[added comment at book]",s)}},deleteComment(e){for(let t=0;t<this.theses.length;t++){if(this.theses[t].id===e)return this.theses.splice(t,1),this.book.comments_count--,void this.totalTheses--;if(this.theses[t].replies.length>0)for(let s=0;s<this.theses[t].replies.length;s++)if(this.theses[t].replies[s].id===e)return this.theses[t].replies.splice(s,1),void this.book.comments_count--}},editComment(e){let t=this.findComment(this.theses,e.id);t.body=e.body,t.media=e.media},reactToComment(e,t){let s=this.findComment(this.theses,e);t?(s.reactions_count++,s.reacted_by_user=!0):(s.reactions_count--,s.reacted_by_user=!1)},download(e){const t=this.$swal.mixin({customClass:{confirmButton:"btn btn-primary btn-lg",cancelButton:"btn btn-outline-primary btn-lg ms-2"},buttonsStyling:!1});t.fire({title:"ملاحظة هامة",text:"في مشروعنا لن لا نقوم أبدًا بتصوير الكتب المطبوعة ولا نقوم بنسب هذه الكتب للمشروع أو محاولة إخفاء أسماء دور النشر وحقوقها . إنما كل ما نقوم به هو عملية البحث عن هذه الكتب في مواقع الانترنت و إحضار روابط الحصول عليها للاستفادة منها . علمًا أننا لا نقوم بعملية بيع للكتب أو الاستفادة المادية منها مطلقًا ولكننا نؤمن أن من حق دور النشر إيجاد وسائل لمنع تصوير كتبها ووضعها على مواقع الانترنت ولكن أن يتواجد الكتاب على الانترنت مجانًا سواء عن طريق موقع لديه أذن بالنشر ، أو عن طريق كاتب الكتاب أو غيرهم ، ثم لا نقوم بقراءة هذه الكتب ونمنع أنفسنا من العلم فهذا الأمر لن يساهم في عملية ايقاف الكتب الالكترونية إنما سوف يساهم فقط بمنع أنفسنا عن علم مطروح وتقييد أنفسنا بظروف تدفعنا للجهل والتوقف عن التعلم . علمًا أن المشروع يتعهد دومًا بحذف أي كتاب من المنهج إذا لم يناسب وجوده كاتب الكتب أو دار النشر الخاصة بالكتاب ، فبإمكان كل شخص إما قراءة الكتاب مطبوعًا أو الاستفادة من النسخ التي نجمعها من مواقع الكتب المنتشرة مع إخلاء مسؤوليتنا حول إن كانت هذه المواقع لديها أذن بالنشر والتوزيع من عدمه فنترك هذا الأمر لدور النشر . هذا ونسأل الله أن يصلح نوايانا ويجعلها خالصة لوجهه الكريم وتطبيقًا لأمره لنا بالقراءة لأجل التعلم والتفكر . والله أعلم .",icon:"warning",confirmButtonText:"تحميل",showClass:{popup:"animate__animated animate__zoomIn"},hideClass:{popup:"animate__animated animate__zoomOut"}}).then((t=>{t.isConfirmed&&window.open(e,"_blank")}))}},computed:{formattedDate(){return re()(this.book?.created_at).format("YYYY-MM-DD")},isMore(){return this.shortBriefText?.length<this.fullBriefText?.length},isLess(){return this.shortBriefText?.length>=this.fullBriefText?.length&&this.fullBriefText?.length>200},hasMoreTheses(){return this.theses.length<this.totalTheses&&this.totalTheses>0&&this.theses.length>0}}},ce=s(83744);const he=(0,ce.Z)(de,[["render",te]]);var me=he}}]);
//# sourceMappingURL=4193.379f2bf4.js.map